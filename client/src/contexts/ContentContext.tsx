import { createContext, useContext, useState, ReactNode } from 'react';

export interface Book {
  id: number;
  title: string;
  content: string;
  level: "beginner" | "intermediate" | "advanced";
  icon: string;
}

export interface Video {
  id: number;
  title: string;
  url: string;
  videoId: string;
  thumbnail: string;
  transcript?: string;
  level: "beginner" | "intermediate" | "advanced";
  icon: string;
}

interface ContentContextType {
  books: Book[];
  videos: Video[];
  currentBook: Book | null;
  currentVideo: Video | null;
  setCurrentBook: (book: Book | null) => void;
  setCurrentVideo: (video: Video | null) => void;
  addBook: (book: Book) => void;
  addVideo: (video: Video) => void;
  updateBook: (book: Book) => void;
  updateVideo: (video: Video) => void;
  deleteBook: (id: number) => void;
  deleteVideo: (id: number) => void;
  fetchTranslation: (word: string) => Promise<string>;
}

const ContentContext = createContext<ContentContextType | undefined>(undefined);

export function ContentProvider({ children }: { children: ReactNode }) {
  const [books, setBooks] = useState<Book[]>([
    {
      id: 1,
      title: "ูุตุต ุงูุฃูุจูุงุก (Qasas Al-Anbiya) - ูุงูู ูุน ุงูุตูุฑ ุงูุฃุตููุฉ",
      content: `<h1>ูุฑุงุกุฉ ุงูุฑุงุดุฏุฉ - ุงูุฌุฒุก ุงูุฃูู ูุงูุซุงูู</h1>
      
      <h2>ุงูุฏุฑุณ ุงูุฃูู: ููููู ุฃูุถู ููููููู</h2>
      
      <h3>ุฑูุชูู ุงูุตุจุงุญ</h3>
      <p>ุฃูุงูู ููุจููููุฑูุง ูู ุงูููููููู ูุฃูููู ููุจููููุฑูุง ููู ุงูุตููุจูุงุญูุ ุฃุณูุชูููููุธู ุนูููู ุงุณููู ุงูููู ูุฐูููุฑููุ ุฃุณูุชูุนูุฏูู ูููุตูููุงุฉู ุซูููู ุฃุฐูููุจู ููุนู ููุงููุฏูู ุฅูู ุงููููุณูุฌูุฏูุ ูุงููููุณูุฌูุฏู ููุฑูููุจู ููู ุจูููุชูููุ ููุฃูุชูููุถููุฃู ูุฃูุตูููููู ููุนู ุงููุฌููุงุนูุฉูุ ูุฃุฑูุฌูุนู ุฅููู ุงูุจูููุชู ูุฃุชูููู ุดูููุฆูุง ููู ุงููููุฑูุขูู ุงููููุฑููููุ ุซูููู ุฃุฎูุฑูุฌู ุฅูู ุงูุจูุณูุชูุงูู ููุฃุฌูุฑูููุ ุซูููู ุฃูุฑูุฌูุนู ุฅูู ุงููุจูููุชู ููุฃูุดูุฑูุจู ุงููููุจููู ูุฃุณูุชูุนูุฏูู ูููุฐูููุงุจู ุฅูู ุงูููุฏูุฑูุณูุฉู.</p>
      
      <h3>ุงููุฏุฑุณุฉ ูุงููุณุงุก</h3>
      <p>ูุฃููุทูุฑู ุฅุฐูุง ูุงููุชู ุฃูููุงูู ุงูุตููููููุ ูุฃุชูุบูุฏููู ุฅุฐูุง ููุงููุชู ุฃูููุงูู ุงูุดููุชุงุกูุ ูุฃุตููู ุฅูู ุงููููุฏูุฑูุณูุฉู ูู ุงููููููุนุงุฏู ููุฃูููููุซู ููู ุงููููุฏูุฑูุณูุฉู ุณูุชูู ุณูุงุนูุงุชูุ ููุฃูุณูููุนู ุงูุฏููุฑูููุณู ุจูููุดูุงุทู ููุฑูุบูุจูุฉูุ ููุฃูุฌูููุณู ุจูุฃูุฏูุจู ููุณููููููุฉูุ ุญูุชููู ุฅูุฐูุง ุงููุชูููู ุงููููููุชู ููุถูุฑูุจู ุงููุฌูุฑูุณู ุฎูุฑูุฌูุชู ูููู ุงููููุฏูุฑูุณูุฉู ููุฑูุฌูุนูุชู ุฅูููู ุงููุจูููุชู.</p><!-- pagebreak -->

      <h2>ุงูุฏุฑุณ ุงูุซุงูู: ููููุง ุจูููุบูุชู ุงูุณููุงุจูุนูุฉู ูููู ุนูููุฑููู</h2>
      
      <h3>ุจุฏุงูุฉ ุชุนูู ุงูุตูุงุฉ</h3>
      <p>ูููููุง ุจูููุบูุชู ุงูุณููุงุจูุนูุฉู ูููู ุนูููุฑููู ุฃูููุฑููููู ุฃูุจููู ุจูุงูุตููููุงุฉูุ ููููููุชู ุชูุนููููููุชู ููุซููุฑูุง ูููู ุงููุฃูุฏูุนูููุฉู ููุญูููุธูุชู ุณูููุฑูุง ูููู ุงููููุฑูุขูู ุงููููุฑูููู ูููู ุฃููููููุ ููููุงููุชู ุฃููููู ุชูุชูููููููู ููุนููู ููููู ููููููุฉู ุนูููุฏู ุงููููููุงูู ููุชูููุตูู ุนูููููู ููุตูุตู ุงููุฃูููุจูููุงุกูุ ููููููุชู ุฃูุณูููุนู ููุฐููู ุงููููุตูุตู ุจูููุดูุงุทู ููุฑูุบูุจูุฉู ููุจูุฏูุฃูุชู ุฃูุฐูููุจู ููุนู ุฃูุจูู ุฅูููู ุงููููุณูุฌูุฏูุ ููุฃููููููู ูููู ุตูููู ุงููุฃูุทูููุงูู ุฎููููู ุตูููู ุงูุฑููุฌูุงูู.</p>
      
      <h3>ุงูุตูุงุฉ ูู ุงููุณุฌุฏ</h3>
      <p>ูููููููุง ุจูููุบูุชู ุงููุนูุงุดูุฑูุฉู ูููู ุนูููุฑููู ููุงูู ููู ููุฑููุฉู: ููุฏู ุฃูููููููุชู ุงููุขูู ูููู ุนูููุฑููู ุชูุณูุนู ุณูููููููุ ููุงูุขูู ุฃูููุชู ุงุจููู ุนูุดูุฑู ุณููููููู ููุฅูุฐูุง ุชูุฑูููุชู ุตูููุงุฉู ุถูุฑูุจูุชูููุ ููุฃูููู ุงููููุจูููู ููุงูู: ููุฑูููุง ุฃูููููุงุฏููููู ุจูุงูุตููููุงุฉู ูููููู ุฃูุจูููุงุกู ุณูุจูุนู ุณููููููุ ููุงุถูุฑูุจูููููู ุนูููููููุง ูููููู ุฃูุจูููุงุกู ุนูุดูุฑู ูููุงูู ููู ุฃูุตูุฏููุงุกู ููู ุงููููุฏูุฑูุณูุฉู.</p><!-- pagebreak -->

      <h2>ุงูุฏุฑุณ ุงูุซุงูุซ: ุงููููููููุฉู (ูุตูุฏุฉ)</h2>
      
      <h3>ุงูุนูู ูุงูุงุฌุชูุงุฏ</h3>
      <div style="text-align: center; font-style: italic; margin: 20px 0;">
        <p>ููุณูุชู ุฃูุฑูุถูู ุจูุงููููุณููู ุทูุงูู ุณูุนููููู ุจูุงููุฃููููู ููุง ุฃูุจูุงูููู ุจูุงูุชููุนูุจู ุบูุงููุชููู ูููููู ุงูุทููููุจู ุจูููุธูุงูู ูููุณูููููู ุฃูุจูุชูููู ุงููุจูููุชู ุงููุญูุณููู ููุณูุชู ููููููุง ุฃูููุนูุจู ููููููููุชููู ุฃูุฐูููุจู ุฃูุฐูููุจู ููู ููููู ุตูุจูุงุญู ุฅูููู ุนูููููู ุจูููุดูุงุทู ููููุฑูุญู ุฃูุฌูููุนู ุงูุทููุนูุงูู ูููุดููุชุงุกู ููุฃูุจูููู ุจูููุชูู ุจูุนูููุงููุฉู ููุฅูุชูููุงูู ุฃูุนูุฑููู ุฃูููู ุงููุนููููู ุจูุฑูููุฉู ููุงููููุณููู ููุฐููููุฉู ููุฐููููู ุฃูุนููููู ุจูุฌูุฏูู ููุงุฌูุชูููุงุฏู ุฃูุญูุฑูุตู ุนูููู ุฅูุชูููุงูู ุนูููููู ููุฃูุณูุนูู ููุชูุญูููููู ุฃูููุฏูุงููู ุจูุตูุจูุฑู ููููุซูุงุจูุฑูุฉู.</p>
      </div><!-- pagebreak -->

      <h2>ุงูุฏุฑุณ ุงูุฑุงุจุน: ููู ุงูุณููููู (ุญูุงุฑ)</h2>
      
      <h3>ุงูููุฏูุฉ ูุงูุฏุนูุฉ ููุฎุฑูุฌ</h3>
      <p><strong>ุนูููุฑู:</strong> ูููู ุฒูุฑูุชู ุณููููู ููุฐูุง ุงููุจูููุฏู ููุง ุตูุฏูููููููุ</p>
      <p><strong>ุฎูุงููุฏู:</strong> ููุง ููุง ุฃูุฎูููุ ููุฅูููููู ุบูุฑูููุจู ุฌูุฏูููุฏู ูููู ููุฐูุง ุงููุจูููุฏู ููุง ุฃูุนูุฑููู ุงูุทููุฑููููู.</p>
      <p><strong>ุนูููุฑู:</strong> ุชูุนูุงูู ููุนููู ููุฅูููููู ุฐูุงููุจู ุฅูููู ุงูุณูููููู ููุฃูุดูุชูุฑููู ุจูุนูุถู ุงููุญูููุงุฆูุฌู ููููุฑูุฌูุน ููุจููู ุงููููุบูุฑูุจู ุฅููู ุดูุงุกูุง ุงูููููู ููุฅูููู ุงูุณูููููู ุบูููุฑู ุจูุนููุฏูุฉู.</p><!-- pagebreak -->
      
      <h3>ุงุณุชูุดุงู ุงูุณูู</h3>
      <p><strong>ุฎูุงููุฏู:</strong> ููุง ุดูุงุกู ุงูููููู ููุฐููู ุณููููู ููุจูููุฑูุฉู ููุงูุฏููููุงูููููู ููุธูููููุฉู ุฌูููููููุฉูุ ููููุง ููุฐูุง ุงูุฏูููููุงูู ุงููุฌููููููู ุฅูููู ุงูููููููููู ููุง ุนูููุฑูุ</p>
      <p><strong>ุนูููุฑู:</strong> ููุฐูุง ุฏููููุงูู ููุงููููุงูููููุ ุฃูููุง ุชูุฑูู ุฅูููู ุงููููููุงูููู ููุชูุฑูู ุงููููุงุณู ููุณูุงูููููููู ุงููููุงููููุงููููู ููููููุง.</p><!-- pagebreak -->

      <h2>ุงูุฏุฑุณ ุงูุฎุงูุณ: ูููู ููููููุนููู ููููููู (ูุตุฉ ุฏูููุฉ)</h2>
      
      <h3>ููุฏูุฉ ุนู ุงูุบุฒูุงุช</h3>
      <p>ุฎูุฑูุฌู ุฑูุณููููู ุงูููููู ุตููููู ุงูููููู ุนููููููู ููุณูููููู ูููู ุบูุฒูููุฉู! ูููู ุชูุนูุฑูููููู ููุง ููู ุงููุบูุฒูููุฉูุ</p>
      <p>ููุนูููููููู ุชูุนูููููููู ุฃูููู ุงููููุณููููููููู ููุงูููุง ููุฎูุฑูุฌููููู ููููุฌูููุงุฏู ูููู ุณูุจููููู ุงูููููู ููููุงููููุง ููููุงุชูููููู ุงููููุดูุฑูููููู ููุงูููููููุงุฑู ููููุฌููู ุงููููู ุชูุนูุงูููุ ููููุนูููููููู ุชูุนูููููููู ููุถูููููุฉู ุงููุฌูููุงุฏู ูููู ุณูุจููููู ุงููููููุ</p>
      
      <h3>ุงูุงุณุชุฑุงุญุฉ ุชุญุช ุงูุดุฌุฑุฉ</h3>
      <p>ููุฎูุฑูุฌู ุฑูุณููู ุงูููู ุตููููู ุงูููู ุนููููู ู ุณูููููู ูู ุบูุฒูููุฉู ููุฑูุฌูุนู ุนูููููุง ููู ุงูุธููููููุฑูุฉู ููููุงููุชู ุฃููููุงูู ุงูุตูููููู ููุฃูุฑูุงุฏู ุฑูุณููููู ุงููููู ุตููููู ุงูููููู ุนููููููู ููุณูููููู ุฃููู ููุณูุชูุฑูููุญู. ููููููุณู ูููู ุงููุจูุฑูููููุฉู ููููุงูู ููุณูุชูุฑูููุญู ูููููู ุงููุฅูููุณูุงูู ุฅููููุง ุงูุดููุฌูุฑู.</p>
      
      <p>ููููุฒููู ุฑูุณููููู ุงูููููู ุตููููู ุงูููููู ุนููููููู ููุณูููููู ุชูุญูุชู ุณูููุฑูุฉู ููุนูููููู ุจูููุง ุณูููููููุ ููุชูููุฑูููู ุงููููุงุณู ููููุงููููุงุ ููููุงูู ุฑูุณููููู ุงูููููู ุตููููู ุงูููููู ุนููููููู ููุณูููููู ุชูุญูุชู ุงูุณููููุฑูุฉู. ููุฌูุงุกู ุฑูุฌููู ูููู ุงููููุดูุฑูููููู ููุณููููู ุฑูุณููููู ุงูููููู ุตููููู ุงูููููู ุนููููููู ููุณูููููู ููุนูููููู ุจูุงูุณููููุฑูุฉู ูููููู ูููู ุบูููุฏููู.</p>`,
      level: "intermediate",
      icon: "๐"
    },
    {
      id: 2,
      title: "ูุฑุงุกุฉ ุงูุฑุงุดุฏุฉ (Qiraatu Al Rashida) - ูุงูู ูุน ุงูุตูุฑ ุงูุฃุตููุฉ",
      content: `<h1>ูุฑุงุกุฉ ุงูุฑุงุดุฏุฉ - ุงูุฌุฒุก ุงูุฃูู ูุงูุซุงูู</h1>
      
      <h2>ุงูุฏุฑุณ ุงูุฃูู: ุงูุชุญูุงุช</h2>
      <p>ุฃููููุงู ููุณููููุงู - ููุฑูุญูุจุงู ุจููููู - ุงูุณููููุงูู ุนููููููููู - ููุนููููููููู ุงูุณููููุงูู</p>
      <p>ููุง ุงุณูููููุ - ุงุณูููู ุฃูุญูููุฏู - ูููู ุฃููููู ุฃูููุชูุ - ุฃูููุง ูููู ููุตูุฑู</p>
      
      <h2>ุงูุฏุฑุณ ุงูุซุงูู: ุงูุฃูุณูุฑูุฉู</h2>  
      <p>ููฐุฐูุง ุฃูุจูู - ููฐุฐููู ุฃููููู - ููฐุฐูุง ุฃูุฎูู - ููฐุฐููู ุฃูุฎูุชูู</p>
      <p>ุฃูุจูู ุทูุจููุจู - ุฃููููู ููุฏูุฑููุณูุฉู - ุฃูุฎูู ุทูุงููุจู - ุฃูุฎูุชูู ุตูุบููุฑูุฉู</p>`,
      level: "beginner",
      icon: "๐"
    },
    {
      id: 3,
      title: "ูุตุต ุงูุฃูุจูุงุก - ุงูุฌุฒุก ุงูุซุงูู",
      content: `ูุตุต ุงูุฃูุจูุงุก - ุงูุฌุฒุก ุงูุซุงูู - Interactive stories from Qasas Al-Anbiya Part 2`,
      level: "beginner",
      icon: "๐"
    },
    {
      id: 3,
      title: "ูุตุต ุงูุฃูุจูุงุก - ุงูุฌุฒุก ุงูุซุงูู (Qasas Al-Anbiya Part 2)",
      content: `<h1>ูุตุต ุงูุฃูุจูุงุก - ุงูุฌุฒุก ุงูุซุงูู</h1>
      
      <h2>ูุตุฉ ููุณู ุนููู ุงูุณูุงู</h2>
      <p>ููุง ุณูุชู ุฅุถุงูุฉ ุงููุญุชูู ูู ูุจู ุงููุณุชุฎุฏู</p>
      
      <h2>ูุตุฉ ุนูุณู ุนููู ุงูุณูุงู</h2>
      <p>ููุง ุณูุชู ุฅุถุงูุฉ ุงููุญุชูู ูู ูุจู ุงููุณุชุฎุฏู</p>
      
      <h2>ูุตุต ุฃุฎุฑู ููุฃูุจูุงุก</h2>
      <p>ููุง ุณูุชู ุฅุถุงูุฉ ุงููุญุชูู ูู ูุจู ุงููุณุชุฎุฏู</p>`,
      level: "intermediate",
      icon: "๐"
    },
    {
      id: 4,
      title: "ุงูุนุจุงุฑุงุช ุงูุฃุณุงุณูุฉ (Basic Phrases)",
      content: `<h1>ุงูุนุจุงุฑุงุช ุงูุฃุณุงุณูุฉ</h1>
      <h2>ุงูุชุญูุงุช</h2>
      <p><strong>ุงูุณูุงู ุนูููู</strong> - Peace be upon you</p>
      <p><strong>ูุนูููู ุงูุณูุงู</strong> - And upon you peace</p>
      <p><strong>ุฃููุงู ูุณููุงู</strong> - Welcome</p>
      <p><strong>ููู ุญุงููุ</strong> - How are you?</p>
      <p><strong>ุจุฎูุฑุ ุงูุญูุฏ ููู</strong> - Fine, praise be to God</p>
      
      <h2>ุงูุนุจุงุฑุงุช ุงูููููุฉ</h2>
      <p><strong>ุดูุฑุงู ูู</strong> - Thank you</p>
      <p><strong>ุนููุงู</strong> - You're welcome</p>
      <p><strong>ุนุฐุฑุงู</strong> - Excuse me/Sorry</p>
      <p><strong>ูู ูุถูู</strong> - Please</p>
      <p><strong>ูุง ุงุณููุ</strong> - What is your name?</p>
      <p><strong>ุงุณูู...</strong> - My name is...</p>`,
      level: "beginner",
      icon: "๐ฌ"
    }
  ]);

  const [videos, setVideos] = useState<Video[]>([
    {
      id: 1,
      title: "Arabic Alphabet Song",
      url: "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
      videoId: "dQw4w9WgXcQ",
      thumbnail: "https://img.youtube.com/vi/dQw4w9WgXcQ/maxresdefault.jpg",
      transcript: "Let's learn the Arabic alphabet! ุฃ ุจ ุช ุซ ุฌ ุญ ุฎ ุฏ ุฐ ุฑ ุฒ ุณ ุด ุต ุถ ุท ุธ ุน ุบ ู ู ู ู ู ู ู ู ู",
      level: "beginner",
      icon: "๐ต"
    },
    {
      id: 2,
      title: "Basic Arabic Greetings",
      url: "https://www.youtube.com/watch?v=example2",
      videoId: "example2",
      thumbnail: "https://img.youtube.com/vi/example2/maxresdefault.jpg",
      transcript: "ูุฑุญุจุง - Hello! ุฃููุง ูุณููุง - Welcome! ููู ุญุงูู - How are you?",
      level: "beginner",
      icon: "๐"
    },
    {
      id: 3,
      title: "Counting in Arabic",
      url: "https://www.youtube.com/watch?v=example3",
      videoId: "example3",
      thumbnail: "https://img.youtube.com/vi/example3/maxresdefault.jpg",
      transcript: "Let's count: ูุงุญุฏ - one, ุงุซูุงู - two, ุซูุงุซุฉ - three, ุฃุฑุจุนุฉ - four, ุฎูุณุฉ - five",
      level: "intermediate",
      icon: "๐ข"
    }
  ]);

  const [currentBook, setCurrentBook] = useState<Book | null>(null);
  const [currentVideo, setCurrentVideo] = useState<Video | null>(null);

  const addBook = (book: Book) => {
    setBooks(prev => [...prev, book]);
  };

  const addVideo = (video: Video) => {
    setVideos(prev => [...prev, video]);
  };

  const updateBook = (updatedBook: Book) => {
    setBooks(prev => prev.map(book => book.id === updatedBook.id ? updatedBook : book));
  };

  const updateVideo = (updatedVideo: Video) => {
    setVideos(prev => prev.map(video => video.id === updatedVideo.id ? updatedVideo : video));
  };

  const deleteBook = (id: number) => {
    setBooks(prev => prev.filter(book => book.id !== id));
    if (currentBook?.id === id) {
      setCurrentBook(null);
    }
  };

  const deleteVideo = (id: number) => {
    setVideos(prev => prev.filter(video => video.id !== id));
    if (currentVideo?.id === id) {
      setCurrentVideo(null);
    }
  };

  const fetchTranslation = async (word: string): Promise<string> => {
    try {
      const response = await fetch('/api/translate', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ word }),
      });
      
      if (response.ok) {
        const data = await response.json();
        return data.translation || 'รbersetzung nicht verfรผgbar';
      }
      return 'รbersetzung nicht verfรผgbar';
    } catch (error) {
      console.error('Translation error:', error);
      return 'รbersetzung nicht verfรผgbar';
    }
  };

  return (
    <ContentContext.Provider 
      value={{
        books,
        videos,
        currentBook,
        currentVideo,
        setCurrentBook,
        setCurrentVideo,
        addBook,
        addVideo,
        updateBook,
        updateVideo,
        deleteBook,
        deleteVideo,
        fetchTranslation
      }}
    >
      {children}
    </ContentContext.Provider>
  );
}

export function useContent() {
  const context = useContext(ContentContext);
  if (context === undefined) {
    throw new Error('useContent must be used within a ContentProvider');
  }
  return context;
}